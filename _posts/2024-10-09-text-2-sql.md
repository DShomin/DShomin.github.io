---
layout: post
title:  "Text-2-SQL 모델 소개"
date:   2024-10-09 20:42:00 +0900
categories: Langgraph
---

## What is Text-2-SQL?

Text-2-SQL은 자연어로 입력된 텍스트를 SQL 쿼리로 변환하는 기술입니다. 사용자가 데이터베이스 구조나 SQL 언어에 대한 지식 없이도, 원하는 질문을 텍스트로 표현하면 이를 자동으로 SQL 쿼리로 변환하여 데이터를 조회할 수 있게 합니다.

## Why do we need Text-2-SQL model?

기업과 조직의 중요한 데이터는 대부분 데이터베이스에 저장되어 있으며, 이 데이터를 기반으로 빠른 의사결정과 분석이 필요합니다. 하지만 SQL을 자유롭게 사용할 수 있는 인력은 제한적이기 때문에, 데이터 분석이나 보고서를 작성하는 데 많은 리소스와 시간이 소요됩니다. Text-2-SQL 모델을 도입하면, 비전문가도 자연어로 데이터베이스에서 직접 정보를 조회할 수 있어 데이터 분석가나 엔지니어의 도움 없이도 실시간으로 정보를 얻고, 신속한 의사결정이 가능해집니다.


## Technologies Used in Text-2-SQL Implementation

`#Langgraph` `#Postgres` `#Docker` `#Plotly`

Text-2-SQL 구현을 위해 다양한 기술이 사용됩니다. 예를 들어, CSV로 제공된 데이터를 `#Postgres` 데이터베이스에 `#Docker`를 통해 배포하고, `#Langgraph`를 이용하여 사용자의 의도를 분석합니다. 이 과정에서 관련 테이블과 컬럼을 자동으로 추출하여 SQL 쿼리를 생성합니다. 생성된 SQL은 사용자가 원하는 데이터 조회와 검증 절차를 거쳐 최종 결과를 확인할 수 있도록 하며, 데이터 시각화가 필요한 경우 `#Plotly`를 활용하여 시각적인 정보도 제공합니다.

![graph](/assets/images/text_2_sql/Langgraph.png)


## Demo 영상
데모 영상은 아래와 같다.
![demo](/assets/images/text_2_sql/output.gif)

## What's next?

1. Table와 Column prompt에 대한 최적화
    현재 Langgraph의 prompt에는 Table과 Column 설명이 포함되어 있지만, 이는 불필요한 토큰 사용을 초래할 수 있으며, 성능 효율성도 떨어질 수 있습니다. 이를 해결하기 위해 RAG(Retrieval-Augmented Generation) 방식을 도입할 수 있습니다. RAG는 필요한 정보만 선택적으로 불러오고 사용하기 때문에, 훨씬 더 효율적이고 정확한 SQL 쿼리를 생성할 수 있도록 합니다. 이 접근법은 필요한 데이터베이스 메타데이터만을 효과적으로 검색하고, 이를 기반으로 SQL 쿼리를 생성하여 성능을 최적화할 수 있습니다.
2. 데이터 분석 Agent 추가
    데이터 분석의 첫 단계는 데이터 전처리입니다. Text-2-SQL 모델에 데이터 전처리 관련 도구들을 통합하여, Agent가 스스로 데이터 정제와 변환을 수행할 수 있는 기능을 추가할 계획입니다. 이를 통해 사용자가 원하는 의사결정 정보와 인사이트를 더욱 정확하게 제공할 수 있게 되며, 모델이 데이터의 품질을 관리함으로써 최종 분석 결과의 신뢰성도 향상됩니다. 이 기능은 의사결정 속도와 품질을 동시에 높이는 데 기여할 것입니다.
3. 다중 Agent를 제어하는 Supervisor Agent 추가
    현재 모델은 단일 Agent로 작동하며, 모든 작업을 수행합니다. 그러나 이를 확장하여 다중 Agent를 제어하는 Supervisor Agent를 추가할 계획입니다. 이를 통해 모델이 복잡한 작업을 더욱 효과적으로 처리할 수 있으며, 각 Agent가 자체적으로 작업을 수행하면서 더욱 빠르고 정확한 결과를 제공할 수 있습니다. 이는 모델의 확장성과 성능을 향상시키는 데 큰 도움이 될 것입니다.